{"version":3,"file":"static/js/39.c2ad3d79.chunk.js","mappings":"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","sources":["firebase/firebase.js","pages/ProfilePage/index.jsx"],"sourcesContent":["import { initializeApp } from \"firebase/app\";\nimport { getStorage } from 'firebase/storage';\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyBGW_j0LEud3iyjGJevWLt4TetIscAWlyY\",\n  authDomain: \"phonebook-381ff.firebaseapp.com\",\n  projectId: \"phonebook-381ff\",\n  storageBucket: \"phonebook-381ff.appspot.com\",\n  messagingSenderId: \"474948812701\",\n  appId: \"1:474948812701:web:8e56c64208b5d5883ff974\"\n};\n\nconst app = initializeApp(firebaseConfig);\nexport const storage = getStorage(app);","import { useEffect, useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport authSelectors from 'redux/auth/authSelectors';\nimport {\n  Title,\n  List,\n  Box,\n  TertiaryButton,\n  SecondaryButton,\n} from 'components/ui';\nimport { BsFillArrowLeftCircleFill } from 'react-icons/bs';\nimport { storage } from '../../firebase/firebase';\nimport { ref, uploadBytes, listAll, getDownloadURL } from 'firebase/storage';\nimport { nanoid } from 'nanoid';\nimport { toast } from 'react-toastify';\nimport { breakpoints } from 'styleConfig/breakpoints';\nimport styled from 'styled-components';\nimport noAvatar from 'assets/noAvatar.jpg';\nimport addPhoto from 'assets/addPhoto.jpg';\nimport { unsetCredentials } from 'redux/auth/authSlice';\nimport { phonebookApi, useLogoutUserMutation } from 'redux/phonebookApiQuery';\n\nconst ProfilePage = () => {\n  const [logoutUser] = useLogoutUserMutation();\n  const [imageUpload, setImageUpload] = useState(null);\n  const [imageList, setImageList] = useState([]);\n  const userName = useSelector(authSelectors.getUserName);\n  const userEmail = useSelector(authSelectors.getUserEmail);\n  const [backLocation, setBackLocation] = useState(null);\n  const dispatch = useDispatch();\n  const location = useLocation();\n  const navigate = useNavigate();\n  const onGoBack = () => navigate(backLocation);\n\n  useEffect(() => {\n    if (!userEmail) return;\n    const imageListRef = ref(storage, `${userEmail}/images/`);\n    listAll(imageListRef).then(response => {\n      response.items.forEach(item => {\n        getDownloadURL(item).then(url => {\n          setImageList(prev => [url, ...prev]);\n        });\n      });\n    });\n  }, [userEmail]);\n\n  useEffect(() => {\n    if (!imageUpload) return;\n    const imageRef = ref(\n      storage,\n      `${userEmail}/images/${imageUpload.name + nanoid()}`\n    );\n    uploadBytes(imageRef, imageUpload).then(snapshot => {\n      toast.success('Image Uploaded');\n      getDownloadURL(snapshot.ref).then(url => {\n        setImageList(prev => [url, ...prev]);\n      });\n    });\n  }, [userEmail, imageUpload]);\n\n  const handleClick = async () => {\n    await logoutUser();\n    dispatch(unsetCredentials());\n    dispatch(phonebookApi.util.resetApiState());\n  };\n\n  useEffect(() => {\n    if (backLocation === null) setBackLocation(location?.state?.from ?? '/');\n  }, [backLocation, location?.state?.from]);\n\n  return (\n    <ProfileWrapper>\n      <Box>\n        <SecondaryButton onClick={onGoBack}>\n          <BsFillArrowLeftCircleFill />\n        </SecondaryButton>\n        <Title>Personal Info</Title>\n        <AvatarWrapper>\n          {imageList.length > 0 ? (\n            <Avatar src={imageList[0]} alt=\"avatar\" />\n          ) : (\n            <Avatar src={noAvatar} alt=\"noAvatar\" />\n          )}\n          <UpLoad>\n            <AvatarInput\n              type=\"file\"\n              onChange={e => setImageUpload(e.target.files[0])}\n            />\n          </UpLoad>\n        </AvatarWrapper>\n        <List>\n          <Item>\n            <Label>Name</Label>\n            <Value>{userName}</Value>\n          </Item>\n          <Item>\n            <Label>Email</Label>\n            <Value>{userEmail}</Value>\n          </Item>\n        </List>\n        <TertiaryButton type=\"button\" onClick={handleClick}>\n          Log out\n        </TertiaryButton>\n      </Box>\n    </ProfileWrapper>\n  );\n};\n\nconst ProfileWrapper = styled.div`\n  height: 100%;\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  margin: 0 auto;\n  background-color: white;\n  background-image: url(assets/background.jpg);\n  background-position: center;\n  background-repeat: no-repeat;\n  background-size: contain;\n`;\nconst Avatar = styled.img`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 150px;\n  height: 190px;\n  border-radius: ${p => p.theme.radii.normal};\n  background-color: transparent;\n  @media (${breakpoints.tablet}) {\n    width: 190px;\n    height: 230px;\n  } ;\n`;\nconst AvatarInput = styled.input`\n  position: absolute;\n  top: 0;\n  right: 0;\n  display: block;\n  width: 50px;\n  height: 50px;\n  opacity: 0;\n  &:hover {\n    cursor: pointer;\n  }\n`;\nconst UpLoad = styled.div`\n  z-index: 10;\n  position: absolute;\n  bottom: -10px;\n  right: -10px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 50px;\n  height: 50px;\n  border-radius: ${p => p.theme.radii.round};\n  border: none;\n  background-color: transparent;\n  background-image: url(${addPhoto});\n  background-position: center;\n  background-repeat: no-repeat;\n  background-size: contain;\n  &:hover ${AvatarInput} {\n    cursor: pointer;\n  }\n`;\nconst AvatarWrapper = styled.div`\n  position: relative;\n  margin: ${p => p.theme.space[3]}px 0;\n`;\nconst Item = styled.li`\n  display: flex;\n  flex-direction: column;\n`;\nconst Label = styled.span`\n  padding-left: ${p => p.theme.space[2]}px;\n  font-size: ${p => p.theme.fontSizes.s};\n  font-weight: ${p => p.theme.fontWeights.semibold};\n  color: ${p => p.theme.colors.primary};\n`;\nconst Value = styled.span`\n  margin-bottom: ${p => p.theme.space[0]}px;\n  padding-left: ${p => p.theme.space[2]}px;\n  font-size: ${p => p.theme.fontSizes.l};\n  font-weight: ${p => p.theme.fontWeights.semibold};\n`;\n\nexport default ProfilePage;\n"],"names":["app","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","storage","getStorage","ProfileWrapper","styled","Avatar","p","theme","radii","normal","breakpoints","AvatarInput","UpLoad","round","addPhoto","AvatarWrapper","space","Item","Label","fontSizes","s","fontWeights","semibold","colors","primary","Value","l","useLogoutUserMutation","logoutUser","useState","imageUpload","setImageUpload","imageList","setImageList","userName","useSelector","authSelectors","userEmail","backLocation","setBackLocation","dispatch","useDispatch","location","useLocation","navigate","useNavigate","useEffect","imageListRef","ref","listAll","then","response","items","forEach","item","getDownloadURL","url","prev","imageRef","name","nanoid","uploadBytes","snapshot","toast","handleClick","unsetCredentials","phonebookApi","state","from","onClick","length","src","alt","noAvatar","type","onChange","e","target","files"],"sourceRoot":""}